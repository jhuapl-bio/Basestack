samtools_index:
  label: "Samtools Index"
  depends: 
    - type: "module"
      id: "samtools"
  image: "staphb/samtools"
  workingdir: "/opt/data"
  orchestrated: false #orchestrated means it r
  init: false
  force_restart: false
  force_init: false
  command: ["bash","-c", "samtools index ${bam}"]
  outputs:
    bam:
      label: "BAM File"
      hint: "BAM file generated from an alignment and sorted"
      watch: True
      type: "file"
      path: ${bam}.bai 
  variables:
    bam:
      label: "BAM File"
      element: "file"
      bind_parent_dir: true
      bind: 
        from: "%{variables.bam.source}"
        to: "/opt/data"
      class: "wb-100  p-3 mb-1"
      source: null
      target: "%{variables.bam.bind.to}/%{variables.bam.source}"
samtools_view_sam_to_bam:
  label: "Samtools BAM from SAM"
  depends: 
    - type: "module"
      id: "samtools"
  image: "staphb/samtools"
  workingdir: "/opt/data"
  orchestrated: false #orchestrated means it r
  init: false
  force_restart: false
  force_init: false
  command: ["bash","-c", "samtools view -S -F4 -b ${sam} | samtools sort > ${sam}.bam"]
  outputs:
    bam:
      label: "Alignment File"
      hint: "Alignment BAM File"
      watch: True
      type: "file"
      path: ${sam}.bam 
  variables:
    sam:
      label: "SAM File"
      element: "file"
      hint: "Alignment SAM file to be converted to BAM"
      bind_parent_dir: true
      bind: 
        from: "%{variables.sam.source}"
        to: "/opt/data"
      class: "wb-100  p-3 mb-1"
      source: null
      target: "%{variables.sam.bind.to}/%{variables.sam.source}"
