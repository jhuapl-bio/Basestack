titan_ont:
  init: false
  hideStatus: true
  label: "Test Titan ONT"
  force_restart: false
  config: null
  orchestrated: true
  binds:
    - "${writePath}/custom:/shared/custom" 
    - "${writePath}/data:/shared/data"
    - "${writePath}/outputs:/shared/outputs"
    - "${writePath}/workflows:/shared/workflows"
  depends: 
    - type: "module"
      id: "dind"
    - type: "service"
      id: "dind"
  image: "jhuaplbio/basestack_orchestrator"
  workingdir: "/shared/custom/data/titan_ONT" #/shared must be identical to that of the Docker in Docker setup. 
  command: ["bash", "-c", "dockstore workflow launch --entry github.com/theiagen/public_health_viral_genomics/Titan_ONT:fja-quasitools-dev --json /shared/custom/data/titan_ONT/Dockstore.json"]
  variables:
    file:
      element: "configuration-file"
      column: 12
      bind_parent_dir: true
      label: "Dockstore Configuration File"
      hint: "Dockstore JSON required to use for the Titan ONT workflow. "
      load: "${writePath}/custom/data/titan_ONT/Dockstore.json"
      create: 
        to: "${writePath}/custom/data/titan_ONT/Dockstore2.json"
        type: "object" 
      copy: 
        from: "%{variables.file.source}"
        to: "${writePath}/custom/data/titan_ONT/"
      # bind: 
      #   from: "${writePath}/custom/data/titan_ONT/Dockstore.json"
      #   to: "/shared/custom/data/titan_ONT"
      source: null
    demux_file:
      element: "file"
      bind_parent_dir: true
      isolated: true
      label: "Demultiplexed File"
      hint: "ONT Demux output, must be only a single barcode"
      copy: 
        basename: true
        from: "%{variables.demux_file.source}"
        to: "${writePath}/custom/data/titan_ONT"
      # bind: 
      #   from: "%{variables.demux_file.source}"
      #   to: "/shared/data"
      source: null
    primer:
      option: 0
      label: "Artic Primer Version "
      hint: "v1-v4 string for artic primer. Also, upload your own"
      options:
        - element: null
          name: "v4"
          source: "${writePath}/workflows/titan_ONT/artic-ncov2019"
          variables:
            name: "nCoV-2019/V4/nCoV-2019.primer.bed"
          bind:  
            from: "%{variables.primer.source}"
            to: "/shared/workflows/titan_ONT/artic-ncov2019"
          target: "/shared/workflows/titan_ONT/artic-ncov2019/primer_schemes/${name}" #This ${} is converted into the variable attribute of selected option only!
        - element:  null
          name: "v3"
          source: "${writePath}/workflows/titan_ONT/artic-ncov2019"
          variables:
            name: "nCoV-2019/V3/nCoV-2019.primer.bed"
          bind: 
            from: "%{variables.primer.source}"
            to: "/shared/workflows/titan_ONT/artic-ncov2019"
          target: "/shared/workflows/titan_ONT/artic-ncov2019/primer_schemes/${name}" #This ${} is converted into the variable attribute of selected option only!
        - name: "custom_file"
          label: "Custom Primer File"
          element: "file"
          bind_parent_dir: true
          bind: 
            from: "%{variables.primer.source}"
            to: "/shared/workflows/titan_ONT/artic-ncov2019/primer_schemes/"
          class: "wb-50  p-3 mb-1"
          source: null
